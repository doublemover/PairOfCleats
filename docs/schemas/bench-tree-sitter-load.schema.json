{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "pairofcleats://schemas/bench-tree-sitter-load.schema.json",
  "title": "Tree-Sitter Load Bench Output",
  "type": "object",
  "required": ["generatedAt", "languages", "filesPerLanguage", "repeats", "useQueries", "scenarios"],
  "properties": {
    "generatedAt": { "type": "string" },
    "languages": {
      "type": "array",
      "minItems": 1,
      "items": { "type": "string", "minLength": 1 }
    },
    "filesPerLanguage": { "type": "integer", "minimum": 1 },
    "repeats": { "type": "integer", "minimum": 1 },
    "useQueries": { "type": "boolean" },
    "scenarios": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": ["cacheMode", "policy", "skipped"],
        "properties": {
          "cacheMode": {
            "type": "string",
            "enum": ["cold", "warm"]
          },
          "policy": {
            "type": "string",
            "enum": ["file-order", "batch-by-language"]
          },
          "skipped": { "type": "boolean" },
          "reason": { "type": "string" },
          "totalFiles": { "type": "integer", "minimum": 0 },
          "totalChunks": { "type": "integer", "minimum": 0 },
          "fallbacks": { "type": "integer", "minimum": 0 },
          "totalMs": { "type": "number", "minimum": 0 },
          "filesPerSec": { "type": "number", "minimum": 0 },
          "chunksPerSec": { "type": "number", "minimum": 0 },
          "perLanguage": {
            "type": "object",
            "additionalProperties": {
              "type": "object",
              "required": ["files", "chunks", "totalMs", "filesPerSec", "chunksPerSec"],
              "properties": {
                "files": { "type": "integer", "minimum": 0 },
                "chunks": { "type": "integer", "minimum": 0 },
                "totalMs": { "type": "number", "minimum": 0 },
                "filesPerSec": { "type": "number", "minimum": 0 },
                "chunksPerSec": { "type": "number", "minimum": 0 }
              },
              "additionalProperties": true
            }
          },
          "treeSitter": {
            "type": "object",
            "required": ["grammarLoads", "grammarLoadFailures", "queryHits", "queryMisses", "cache", "paths"],
            "properties": {
              "grammarLoads": { "type": "integer", "minimum": 0 },
              "grammarLoadFailures": { "type": "integer", "minimum": 0 },
              "queryHits": { "type": "integer", "minimum": 0 },
              "queryMisses": { "type": "integer", "minimum": 0 },
              "cache": { "type": "object" },
              "paths": { "type": "object" }
            },
            "additionalProperties": true
          }
        },
        "allOf": [
          {
            "if": {
              "properties": {
                "skipped": { "const": false }
              },
              "required": ["skipped"]
            },
            "then": {
              "required": [
                "totalFiles",
                "totalChunks",
                "fallbacks",
                "totalMs",
                "filesPerSec",
                "chunksPerSec",
                "perLanguage",
                "treeSitter"
              ]
            }
          },
          {
            "if": {
              "properties": {
                "skipped": { "const": true }
              },
              "required": ["skipped"]
            },
            "then": {
              "required": ["reason"]
            }
          }
        ],
        "additionalProperties": true
      }
    }
  },
  "additionalProperties": true
}
