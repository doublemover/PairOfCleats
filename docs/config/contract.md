# Config Contract

This file is generated by `node tools/config/contract-doc.js`.
Sources:
- `docs/config/schema.json` (config keys + enums)
- `src/shared/env.js` (env overrides)

## Top-level namespaces

- cache
- indexing
- mcp
- quality
- retrieval
- runtime
- search
- threads
- tooling

## Config keys (full list)

```
cache (object)
cache.root (string)
indexing (object)
indexing.concurrency (number)
indexing.embeddings (object)
indexing.embeddings.cache (object)
indexing.embeddings.cache.dir (string)
indexing.embeddings.cache.maxAgeDays (number)
indexing.embeddings.cache.maxGb (number)
indexing.embeddings.cache.scope (string) enum=global|repo|local
indexing.embeddings.concurrency (number)
indexing.embeddings.onnx (object)
indexing.embeddings.onnx.interOpNumThreads (number)
indexing.embeddings.onnx.intraOpNumThreads (number)
indexing.embeddings.provider (string)
indexing.fileCaps (object)
indexing.fileCaps.byExt (object)
indexing.fileCaps.byExt.* (object)
indexing.fileCaps.byExt.*.maxBytes (number)
indexing.fileCaps.byExt.*.maxLines (number)
indexing.fileCaps.byLanguage (object)
indexing.fileCaps.byLanguage.* (object)
indexing.fileCaps.byLanguage.*.maxBytes (number)
indexing.fileCaps.byLanguage.*.maxLines (number)
indexing.fileCaps.byMode (object)
indexing.fileCaps.byMode.code (object)
indexing.fileCaps.byMode.code.maxBytes (number)
indexing.fileCaps.byMode.code.maxLines (number)
indexing.fileCaps.byMode.extracted-prose (object)
indexing.fileCaps.byMode.extracted-prose.maxBytes (number)
indexing.fileCaps.byMode.extracted-prose.maxLines (number)
indexing.fileCaps.byMode.prose (object)
indexing.fileCaps.byMode.prose.maxBytes (number)
indexing.fileCaps.byMode.prose.maxLines (number)
indexing.fileCaps.byMode.records (object)
indexing.fileCaps.byMode.records.maxBytes (number)
indexing.fileCaps.byMode.records.maxLines (number)
indexing.fileCaps.default (object)
indexing.fileCaps.default.maxBytes (number)
indexing.fileCaps.default.maxLines (number)
indexing.graph (object)
indexing.graph.caps (object)
indexing.graph.caps.maxEdges (number)
indexing.graph.caps.maxNodes (number)
indexing.importConcurrency (number)
indexing.ioConcurrencyCap (number)
indexing.maxFileBytes (number)
indexing.maxFileLines (number)
indexing.riskInterprocedural (object)
indexing.riskInterprocedural.caps (object)
indexing.riskInterprocedural.caps.maxCallSitesPerEdge (number)
indexing.riskInterprocedural.caps.maxDepth (number)
indexing.riskInterprocedural.caps.maxEdgeExpansions (number)
indexing.riskInterprocedural.caps.maxMs (number|null)
indexing.riskInterprocedural.caps.maxPathsPerPair (number)
indexing.riskInterprocedural.caps.maxTotalFlows (number)
indexing.riskInterprocedural.emitArtifacts (string) enum=none|jsonl|off
indexing.riskInterprocedural.enabled (boolean)
indexing.riskInterprocedural.sanitizerPolicy (string) enum=terminate|weaken
indexing.riskInterprocedural.strictness (string) enum=conservative|argAware
indexing.riskInterprocedural.summaryOnly (boolean)
indexing.scm (object)
indexing.scm.annotate (object)
indexing.scm.annotate.enabled (boolean)
indexing.scm.annotate.maxFileSizeBytes (number)
indexing.scm.annotate.timeoutMs (number)
indexing.scm.churnWindowCommits (number)
indexing.scm.jj (object)
indexing.scm.jj.snapshotWorkingCopy (boolean)
indexing.scm.maxConcurrentProcesses (number)
indexing.scm.provider (string) enum=auto|git|jj|none
indexing.scm.timeoutMs (number)
mcp (object)
mcp.maxBufferBytes (number)
mcp.mode (string) enum=legacy|sdk|auto
mcp.queueMax (number)
mcp.toolTimeoutMs (number)
mcp.toolTimeouts (object)
quality (string) enum=auto|fast|balanced|max
retrieval (object)
retrieval.contextExpansion (object)
retrieval.contextExpansion.enabled (boolean)
retrieval.contextExpansion.includeCalls (boolean)
retrieval.contextExpansion.includeExports (boolean)
retrieval.contextExpansion.includeImports (boolean)
retrieval.contextExpansion.includeUsages (boolean)
retrieval.contextExpansion.maxCallEdges (number)
retrieval.contextExpansion.maxExportEdges (number)
retrieval.contextExpansion.maxImportEdges (number)
retrieval.contextExpansion.maxNameCandidates (number)
retrieval.contextExpansion.maxPerHit (number)
retrieval.contextExpansion.maxReasons (number)
retrieval.contextExpansion.maxTotal (number)
retrieval.contextExpansion.maxUsageEdges (number)
retrieval.contextExpansion.maxWallClockMs (number)
retrieval.contextExpansion.maxWorkUnits (number)
retrieval.contextExpansion.respectFilters (boolean)
retrieval.graph (object)
retrieval.graph.caps (object)
retrieval.graph.caps.maxCandidates (number)
retrieval.graph.caps.maxDepth (number)
retrieval.graph.caps.maxEdges (number)
retrieval.graph.caps.maxFanoutPerNode (number)
retrieval.graph.caps.maxNodes (number)
retrieval.graph.caps.maxPaths (number)
retrieval.graph.caps.maxWallClockMs (number)
retrieval.graph.caps.maxWorkUnits (number)
retrieval.graphRanking (object)
retrieval.graphRanking.enabled (boolean)
retrieval.graphRanking.maxGraphWorkUnits (number)
retrieval.graphRanking.maxWallClockMs (number)
retrieval.graphRanking.seedK (number)
retrieval.graphRanking.seedSelection (string)
retrieval.graphRanking.weights (object)
runtime (object)
runtime.ioOversubscribe (boolean)
runtime.maxOldSpaceMb (number)
runtime.nodeOptions (string)
runtime.uvThreadpoolSize (number)
search (object)
search.annDefault (boolean)
search.denseVectorMode (string) enum=merged|code|doc|auto
search.fieldWeights (object)
search.maxCandidates (number)
search.rrf (object)
search.rrf.enabled (boolean)
search.rrf.k (number)
search.scoreBlend (object)
search.scoreBlend.annWeight (number)
search.scoreBlend.enabled (boolean)
search.scoreBlend.sparseWeight (number)
search.sqliteAutoArtifactBytes (number)
search.sqliteAutoChunkThreshold (number)
search.sqliteFtsWeights
threads (number)
tooling (object)
tooling.allowGlobalFallback (boolean)
tooling.autoEnableOnDetect (boolean)
tooling.autoInstallOnDetect (boolean)
tooling.cache (object)
tooling.cache.dir (string)
tooling.cache.enabled (boolean)
tooling.circuitBreakerThreshold (number)
tooling.clangd (object)
tooling.clangd.compileCommandsDir (string)
tooling.clangd.requireCompilationDatabase (boolean)
tooling.dir (string)
tooling.disabledTools
tooling.enabledTools
tooling.installScope (string)
tooling.logDir (string)
tooling.lsp (object)
tooling.lsp.enabled (boolean)
tooling.lsp.servers (array)
tooling.lsp.servers[] (object)
tooling.lsp.servers[].args
tooling.lsp.servers[].cmd (string)
tooling.lsp.servers[].id (string)
tooling.lsp.servers[].label (string)
tooling.lsp.servers[].languages
tooling.lsp.servers[].priority (number)
tooling.lsp.servers[].retries (number)
tooling.lsp.servers[].timeoutMs (number)
tooling.lsp.servers[].uriScheme (string) enum=file|poc-vfs
tooling.lsp.servers[].version (string)
tooling.maxRetries (number)
tooling.providerOrder
tooling.pyright (object)
tooling.sourcekit (object)
tooling.strict (boolean)
tooling.timeoutMs (number)
tooling.typescript (object)
tooling.typescript.allowJs (boolean)
tooling.typescript.checkJs (boolean)
tooling.typescript.enabled (boolean)
tooling.typescript.includeJsx (boolean)
tooling.typescript.maxFileBytes (number)
tooling.typescript.maxFiles (number)
tooling.typescript.maxProgramFiles (number)
tooling.typescript.resolveOrder
tooling.typescript.tsconfigPath (string)
tooling.typescript.useTsconfig (boolean)
tooling.vfs (object)
tooling.vfs.coalesceSegments (boolean)
tooling.vfs.coldStartCache (object)
tooling.vfs.coldStartCache.cacheRoot (string)
tooling.vfs.coldStartCache.enabled (boolean)
tooling.vfs.coldStartCache.maxAgeDays (number)
tooling.vfs.coldStartCache.maxBytes (number)
tooling.vfs.hashRouting (boolean)
tooling.vfs.ioBatching (object)
tooling.vfs.ioBatching.enabled (boolean)
tooling.vfs.ioBatching.flushIntervalMs (number)
tooling.vfs.ioBatching.maxBatchBytes (number)
tooling.vfs.ioBatching.maxInflight (number)
tooling.vfs.ioBatching.maxQueueEntries (number)
tooling.vfs.ioBatching.writeMode (string) enum=atomic|direct
tooling.vfs.maxVirtualFileBytes (number)
tooling.vfs.strict (boolean)
tooling.vfs.tokenMode (string)
```

## Defaults

- (no defaults declared in schema)

## Env overrides (runtime)

- MCP_MODE -> mcpMode
- PAIROFCLEATS_API_TOKEN -> apiToken
- PAIROFCLEATS_BUNDLE_THREADS -> bundleThreads
- PAIROFCLEATS_CACHE_ROOT -> cacheRoot
- PAIROFCLEATS_COMPRESSION -> compression
- PAIROFCLEATS_DEBUG_CRASH -> debugCrash
- PAIROFCLEATS_DICT_DIR -> dictDir
- PAIROFCLEATS_DISCOVERY_STAT_CONCURRENCY -> discoveryStatConcurrency
- PAIROFCLEATS_DOC_EXTRACT -> docExtract
- PAIROFCLEATS_EMBEDDINGS -> embeddings
- PAIROFCLEATS_EXTENSIONS_DIR -> extensionsDir
- PAIROFCLEATS_FILE_CACHE_MAX -> fileCacheMax
- PAIROFCLEATS_HOME -> homeRoot
- PAIROFCLEATS_IMPORT_GRAPH -> importGraph
- PAIROFCLEATS_LANCEDB_CHILD -> child
- PAIROFCLEATS_LANCEDB_ISOLATE -> isolate
- PAIROFCLEATS_LANCEDB_PAYLOAD -> payload
- PAIROFCLEATS_LOG_FORMAT -> logFormat
- PAIROFCLEATS_LOG_LEVEL -> logLevel
- PAIROFCLEATS_MCP_MAX_BUFFER_BYTES -> mcpMaxBufferBytes
- PAIROFCLEATS_MCP_MODE -> mcpMode
- PAIROFCLEATS_MCP_QUEUE_MAX -> mcpQueueMax
- PAIROFCLEATS_MCP_TOOL_TIMEOUT_MS -> mcpToolTimeoutMs
- PAIROFCLEATS_MCP_TRANSPORT -> mcpTransport
- PAIROFCLEATS_MODELS_DIR -> modelsDir
- PAIROFCLEATS_REGEX_ENGINE -> regexEngine
- PAIROFCLEATS_STAGE -> stage
- PAIROFCLEATS_SUMMARY_CACHE_MAX -> summaryCacheMax
- PAIROFCLEATS_THREADS -> threads
- PAIROFCLEATS_VERBOSE -> verbose
- PAIROFCLEATS_WATCHER_BACKEND -> watcherBackend
- PAIROFCLEATS_WORKER_POOL -> workerPool
- PAIROFCLEATS_XXHASH_BACKEND -> xxhashBackend

## Env overrides (test-only, require PAIROFCLEATS_TESTING=1)

- PAIROFCLEATS_TEST_ALLOW_MISSING_COMPAT_KEY -> allowMissingCompatKey
- PAIROFCLEATS_TEST_CONFIG
- PAIROFCLEATS_TEST_MAX_JSON_BYTES -> maxJsonBytes
- PAIROFCLEATS_TEST_MCP_DELAY_MS -> mcpDelayMs

## CLI flags

### build_index / pairofcleats index build

- --config-dump
- --debug-crash
- --dims
- --incremental (alias: i)
- --json
- --log-file
- --log-format
- --mode
- --model
- --no-scm-annotate
- --progress
- --quality
- --quiet
- --repo
- --scm-annotate
- --scm-provider
- --sqlite
- --stage
- --stub-embeddings
- --threads
- --verbose
- --watch
- --watch-debounce
- --watch-poll

### search / pairofcleats search

- --alias
- --ann
- --ann-backend
- --async
- --author
- --awaits
- --backend
- --bm25-b
- --bm25-k1
- --branch
- --branches
- --breaks
- --calls
- --case
- --case-file
- --case-tokens
- --chunk-author
- --churn
- --comments
- --compact
- --continues
- --decorator
- --dense-vector-mode
- --explain
- --ext
- --extends
- --file
- --filter
- --fts-profile
- --fts-weights
- --generator
- --graph-ranking-max-ms
- --graph-ranking-max-work
- --graph-ranking-seed-k
- --graph-ranking-seeds
- --import
- --inferred-type
- --json
- --lang
- --lint
- --loops
- --matched
- --meta
- --meta-json
- --mode
- --model
- --modified-after
- --modified-since
- --mutates
- --n
- --non-strict
- --param
- --path
- --reads
- --repo
- --return-type
- --returns
- --risk
- --risk-category
- --risk-flow
- --risk-sink
- --risk-source
- --risk-tag
- --signature
- --stats
- --struct-pack
- --struct-rule
- --struct-tag
- --stub-embeddings
- --throws
- --top
- --type
- --uses
- --visibility
- --why
- --writes

Notes:
- Boolean flags accept `--no-<flag>` unless a command overrides negation behavior.
- Search options list is derived from `src/retrieval/cli-args.js`.
