{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "PairOfCleats configuration",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "profile": { "type": "string" },
    "dictionary": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "dir": { "type": "string" },
        "languages": { "type": "array", "items": { "type": "string" } },
        "files": { "type": "array", "items": { "type": "string" } },
        "includeSlang": { "type": "boolean" },
        "slangDirs": { "type": "array", "items": { "type": "string" } },
        "slangFiles": { "type": "array", "items": { "type": "string" } },
        "enableRepoDictionary": { "type": "boolean" },
        "segmentation": { "type": "string" },
        "dpMaxTokenLength": { "type": "number" },
        "dpMaxTokenLengthByFileCount": {
          "type": "array",
          "items": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "maxFiles": { "type": "number" },
              "dpMaxTokenLength": { "type": "number" }
            }
          }
        }
      }
    },
    "cache": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "root": { "type": "string" },
        "runtime": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "fileText": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "maxMb": { "type": "number" },
                "ttlMs": { "type": "number" }
              }
            },
            "summary": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "maxMb": { "type": "number" },
                "ttlMs": { "type": "number" }
              }
            },
            "lint": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "maxMb": { "type": "number" },
                "ttlMs": { "type": "number" }
              }
            },
            "complexity": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "maxMb": { "type": "number" },
                "ttlMs": { "type": "number" }
              }
            },
            "gitMeta": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "maxMb": { "type": "number" },
                "ttlMs": { "type": "number" }
              }
            }
          }
        },
        "gc": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "maxBytes": { "type": "number" },
            "maxGb": { "type": "number" },
            "maxAgeDays": { "type": "number" }
          }
        }
      }
    },
    "sqlite": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "use": { "type": "boolean" },
        "dbDir": { "type": "string" },
        "dbPath": { "type": "string" },
        "codeDbPath": { "type": "string" },
        "proseDbPath": { "type": "string" },
        "scoreMode": { "type": "string" },
        "annMode": { "type": "string" },
        "compactOnIncremental": { "type": "boolean" },
        "vectorExtension": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enabled": { "type": "boolean" },
            "annMode": { "type": "string" },
            "provider": { "type": "string" },
            "module": { "type": "string" },
            "encoding": { "type": "string" },
            "table": { "type": "string" },
            "column": { "type": "string" },
            "options": { "type": "string" },
            "dir": { "type": "string" },
            "filename": { "type": "string" },
            "path": { "type": "string" },
            "url": { "type": "string" },
            "downloads": { "type": "object", "additionalProperties": true },
            "platform": { "type": "string" },
            "arch": { "type": "string" }
          }
        }
      }
    },
    "search": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "annDefault": { "type": "boolean" },
        "sqliteAutoChunkThreshold": { "type": "number" },
        "sqliteAutoArtifactBytes": { "type": "number" },
        "sqliteFtsNormalize": { "type": "boolean" },
        "sqliteFtsProfile": { "type": "string" },
        "denseVectorMode": { "type": "string", "enum": ["merged", "code", "doc", "auto"] },
          "sqliteFtsWeights": {
            "type": ["array", "object"],
            "items": { "type": "number" },
            "additionalProperties": false,
            "properties": {
              "file": { "type": "number" },
              "name": { "type": "number" },
              "signature": { "type": "number" },
              "kind": { "type": "number" },
              "headline": { "type": "number" },
              "doc": { "type": "number" },
              "tokens": { "type": "number" }
            }
          },
        "scoreBlend": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enabled": { "type": "boolean" },
            "sparseWeight": { "type": "number" },
            "annWeight": { "type": "number" }
          }
        },
        "symbolBoost": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enabled": { "type": "boolean", "default": true },
            "definitionWeight": { "type": "number", "default": 1.2 },
            "exportWeight": { "type": "number", "default": 1.1 }
          }
        },
        "minhashMaxDocs": { "type": "number" },
        "queryCache": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enabled": { "type": "boolean" },
            "maxEntries": { "type": "number" },
            "ttlMs": { "type": "number" }
          }
        },
        "filePrefilter": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enabled": { "type": "boolean" },
            "chargramN": { "type": "number" }
          }
        },
        "bm25": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "k1": { "type": "number" },
            "b": { "type": "number" }
          }
        },
        "fieldWeights": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "name": { "type": "number" },
            "signature": { "type": "number" },
            "doc": { "type": "number" },
            "body": { "type": "number" }
          }
        },
        "contextExpansion": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enabled": { "type": "boolean" },
            "maxPerHit": { "type": "number" },
            "maxTotal": { "type": "number" },
            "includeCalls": { "type": "boolean" },
            "includeImports": { "type": "boolean" },
            "includeExports": { "type": "boolean" },
            "includeUsages": { "type": "boolean" },
            "respectFilters": { "type": "boolean" }
          }
        },
        "rrf": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enabled": { "type": "boolean" },
            "k": { "type": "number" }
          }
        }
      }
    },
    "triage": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "recordsDir": { "type": "string" },
        "storeRawPayload": { "type": "boolean" },
        "promoteFields": { "type": "array", "items": { "type": "string" } },
        "contextPack": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "maxHistory": { "type": "number" },
            "maxEvidencePerQuery": { "type": "number" }
          }
        }
      }
    },
    "indexing": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "concurrency": { "type": "number" },
        "importConcurrency": { "type": "number" },
        "maxFileBytes": { "type": ["number", "boolean"] },
        "fileCaps": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "default": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "maxBytes": { "type": "number" },
                "maxLines": { "type": "number" }
              }
            },
            "byExt": {
              "type": "object",
              "additionalProperties": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "maxBytes": { "type": "number" },
                  "maxLines": { "type": "number" }
                }
              }
            },
            "byLanguage": {
              "type": "object",
              "additionalProperties": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "maxBytes": { "type": "number" },
                  "maxLines": { "type": "number" }
                }
              }
            }
          }
        },
        "fileScan": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "sampleBytes": { "type": "number" },
            "minified": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "sampleMinBytes": { "type": "number" },
                "minChars": { "type": "number" },
                "singleLineChars": { "type": "number" },
                "avgLineThreshold": { "type": "number" },
                "maxLineThreshold": { "type": "number" },
                "maxWhitespaceRatio": { "type": "number" }
              }
            },
            "binary": {
              "type": "object",
              "additionalProperties": false,
              "properties": {
                "sampleMinBytes": { "type": "number" },
                "maxNonTextRatio": { "type": "number" }
              }
            }
          }
        },
        "astDataflow": { "type": "boolean" },
        "controlFlow": { "type": "boolean" },
        "javascriptParser": { "type": "string" },
        "javascriptFlow": { "type": ["string", "boolean"] },
        "typescriptParser": { "type": "string" },
        "typescript": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "importsOnly": { "type": "boolean" },
            "embeddingBatchMultiplier": { "type": "number" }
          }
        },
        "pythonAst": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enabled": { "type": "boolean" },
            "workerCount": { "type": "number" },
            "maxWorkers": { "type": "number" },
            "scaleUpQueueMs": { "type": "number" },
            "taskTimeoutMs": { "type": "number" },
            "maxRetries": { "type": "number" }
          }
        },
          "kotlin": {
            "type": "object",
            "additionalProperties": false,
          "properties": {
            "flowMaxBytes": { "type": "number" },
            "flowMaxLines": { "type": "number" },
            "relationsMaxBytes": { "type": "number" },
            "relationsMaxLines": { "type": "number" }
          }
        },
        "embeddingBatchSize": { "type": "number" },
        "embeddingBatchMultipliers": {
          "type": "object",
          "additionalProperties": { "type": "number" }
        },
        "embeddings": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "enabled": { "type": "boolean" },
              "concurrency": { "type": "number" },
              "mode": {
                "type": "string",
                "enum": ["auto", "inline", "service", "stub", "off"]
              },
              "queue": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "dir": { "type": "string" },
                  "maxQueued": { "type": "number" }
                }
              },
              "cache": {
                "type": "object",
                "additionalProperties": false,
                "properties": {
                  "dir": { "type": "string" }
                }
              }
            }
          },
          "twoStage": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "enabled": { "type": "boolean" },
              "background": { "type": "boolean" },
              "queue": { "type": "boolean" },
              "stage1": { "type": "object", "additionalProperties": true },
              "stage2": { "type": "object", "additionalProperties": true },
              "stage3": { "type": "object", "additionalProperties": true },
              "stage4": { "type": "object", "additionalProperties": true }
            }
          },
          "shards": {
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "enabled": { "type": "boolean" },
              "maxWorkers": { "type": "number" },
              "maxShards": { "type": "number" },
              "minFiles": { "type": "number" },
              "dirDepth": { "type": "number" }
            }
          },
          "chunkTokenMode": { "type": "string", "enum": ["auto", "full", "sample", "none"] },
        "chunkTokenMaxFiles": { "type": "number" },
        "chunkTokenMaxTokens": { "type": "number" },
        "chunkTokenSampleSize": { "type": "number" },
        "artifactCompression": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enabled": { "type": "boolean" },
            "mode": { "type": "string" },
            "keepRaw": { "type": "boolean" }
          }
        },
        "artifacts": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "mode": { "type": "string" },
            "chunkMetaFormat": { "type": "string" },
            "chunkMetaJsonlThreshold": { "type": "number" },
            "chunkMetaShardSize": { "type": "number" },
            "tokenPostingsFormat": { "type": "string" },
            "tokenPostingsShardSize": { "type": "number" },
            "tokenPostingsShardThreshold": { "type": "number" }
          }
        },
        "treeSitter": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enabled": { "type": ["boolean", "string"] },
            "maxBytes": { "type": "number" },
            "maxLines": { "type": "number" },
            "languages": {
              "type": "object",
              "additionalProperties": { "type": "boolean" },
              "properties": {
                "swift": { "type": "boolean" },
                "kotlin": { "type": "boolean" },
                "csharp": { "type": "boolean" },
                "clike": { "type": "boolean" },
                "cpp": { "type": "boolean" },
                "objc": { "type": "boolean" },
                "go": { "type": "boolean" },
                "rust": { "type": "boolean" },
                "java": { "type": "boolean" }
              }
            }
          }
        },
        "workerPool": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enabled": { "type": ["boolean", "string"] },
            "maxWorkers": { "type": "number" },
            "maxFileBytes": { "type": "number" },
            "idleTimeoutMs": { "type": "number" },
            "taskTimeoutMs": { "type": "number" },
            "quantizeBatchSize": { "type": "number" }
          }
        },
        "riskAnalysis": { "type": "boolean" },
        "riskAnalysisCrossFile": { "type": "boolean" },
        "typeInference": { "type": "boolean" },
        "typeInferenceCrossFile": { "type": "boolean" },
        "gitBlame": { "type": "boolean" },
        "lint": { "type": "boolean" },
        "complexity": { "type": "boolean" },
        "debugFileLists": { "type": "boolean" },
        "fileListSampleSize": { "type": "number" },
        "yamlChunking": { "type": "string", "enum": ["auto", "root", "top-level"] },
        "yamlTopLevelMaxBytes": { "type": "number" },
        "debugCrash": { "type": "boolean" },
        "postings": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enablePhraseNgrams": { "type": "boolean" },
            "phraseMinN": { "type": "number" },
            "phraseMaxN": { "type": "number" },
            "enableChargrams": { "type": "boolean" },
            "chargramMinN": { "type": "number" },
            "chargramMaxN": { "type": "number" },
            "chargramMaxTokenLength": { "type": "number" },
            "chargramSource": { "type": "string", "enum": ["full", "fields"] },
            "fielded": { "type": "boolean" }
          }
        }
      }
    },
    "sql": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "dialect": { "type": "string" },
        "dialectByExt": {
          "type": "object",
          "additionalProperties": { "type": "string" }
        }
      }
    },
    "models": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "id": { "type": "string" },
        "dir": { "type": "string" },
        "compare": { "type": "array", "items": { "type": "string" } }
      }
    },
    "runtime": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "maxOldSpaceMb": { "type": "number" },
        "nodeOptions": { "type": "string" }
      }
    },
    "tooling": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "autoInstallOnDetect": { "type": "boolean" },
        "autoEnableOnDetect": { "type": "boolean" },
        "installScope": { "type": "string" },
        "allowGlobalFallback": { "type": "boolean" },
        "dir": { "type": "string" },
        "enabledTools": { "type": "array", "items": { "type": "string" } },
        "disabledTools": { "type": "array", "items": { "type": "string" } },
        "typescript": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "enabled": { "type": "boolean" },
            "resolveOrder": { "type": ["array", "string"], "items": { "type": "string" } },
            "useTsconfig": { "type": "boolean" },
            "tsconfigPath": { "type": "string" }
          }
        },
        "clangd": {
          "type": "object",
          "additionalProperties": false,
          "properties": {
            "requireCompilationDatabase": { "type": "boolean" },
            "compileCommandsDir": { "type": "string" }
          }
        }
      }
    },
    "extensions": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "dir": { "type": "string" }
      }
    },
    "useDefaultSkips": { "type": "boolean" },
    "useGitignore": { "type": "boolean" },
    "usePairofcleatsIgnore": { "type": "boolean" },
    "ignoreFiles": { "type": "array", "items": { "type": "string" } },
    "extraIgnore": { "type": "array", "items": { "type": "string" } }
  }
}
